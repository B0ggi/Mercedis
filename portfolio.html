<!DOCTYPE html>
<html lang="fo">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ellinor Mercedis - Listaverk</title>
    
    <!-- Performance optimizations -->
    <link rel="preload" href="data/artworks.json" as="fetch" crossorigin>
    <link rel="preload" href="assets/css/portfolio.css" as="style">
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300italic,600italic,300,600">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css">
    <link rel="stylesheet" href="assets/css/main.css" />
    <link rel="stylesheet" href="assets/css/navigation.css" />
    <link rel="stylesheet" href="assets/css/custom.css" />
    <link rel="stylesheet" href="assets/css/portfolio.css" />
    <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body class="page-layout">
    <!-- Navigation will be inserted here by navigation.js -->
    <nav id="navigation-placeholder"></nav>

    <main class="main-content">
        <header class="container">
            <div class="page-header">
                <h1>Listaverk</h1>
            </div>

            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="all">Øll listaverk</button>
                <button class="filter-btn" data-filter="available">Tøk listaverk</button>
                <button class="filter-btn" data-filter="y2025">2025</button>
                <button class="filter-btn" data-filter="y2024">2024</button>
            </div>
        </header>
        
        <div class="portfolio-grid" id="portfolio-grid">
          <!-- Artworks will be inserted here by JavaScript -->
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            const portfolioGrid = document.getElementById('portfolio-grid');
            const filterButtons = document.querySelectorAll('.filter-btn');

            async function loadArtworks() {
                try {
                    const response = await fetch('data/artworks.json');
                    if (!response.ok) throw new Error(`HTTP error: ${response.status}`);
                    const data = await response.json();
                    return data.artworks;
                } catch (error) {
                    console.error('Failed to load artworks:', error);
                    return [];
                }
            }

            const artworks = await loadArtworks();

            function createArtworkElement(art) {
                const item = document.createElement('div');
                item.className = 'portfolio-item';

                item.innerHTML = `
                    <a href="${art.image}" data-gallery="portfolio-gallery" title="${art.title}">
                        <img src="${art.image}" alt="${art.title}" loading="lazy" onerror="this.onerror=null;this.src='images/placeholder.jpg';">
                        <div class="artwork-overlay">
                            <div class="artwork-info">
                                <h3>${art.title}</h3>
                                <div class="artwork-meta">
                                    <span>${art.year}</span>
                                    ${art.technique ? `<span>${art.technique}</span>` : ''}
                                    <span class="availability ${art.available ? 'available' : 'not-available'}">${art.available ? 'Tøkt' : 'Selt'}</span>
                                </div>
                            </div>
                        </div>
                    </a>`;
                return item;
            }

            function renderArtworks(filter = 'all') {
                portfolioGrid.innerHTML = '';

                if (!artworks || artworks.length === 0) {
                    portfolioGrid.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; color: #666;">Ongi listaverk funnin.</p>';
                    return;
                }

                let filteredArtworks;
                if (filter === 'all') {
                    filteredArtworks = artworks;
                } else if (filter === 'available') {
                    filteredArtworks = artworks.filter(art => art.available);
                } else {
                    filteredArtworks = artworks.filter(art => art.categories.includes(filter));
                }

                if (filteredArtworks.length === 0) {
                    portfolioGrid.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; color: #666;">Ongi listaverk funnin fyri hetta filtrið.</p>';
                    return;
                }

                filteredArtworks.forEach(art => {
                    const item = createArtworkElement(art);
                    portfolioGrid.appendChild(item);
                });

                // Re-initialize Magnific Popup
                $('.portfolio-grid').magnificPopup({
                    delegate: 'a[data-gallery="portfolio-gallery"]',
                    type: 'image',
                    gallery: { enabled: true }
                });
            }

            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    const filter = this.getAttribute('data-filter');
                    renderArtworks(filter);
                });
            });

            // Initial render
            renderArtworks('all');
        });
    </script>

    <!-- Scripts - Load in correct order -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
    <script src="assets/js/navigation.js" defer></script>

    <script>
        // Mobile menu toggle
        const hamburger = document.getElementById('hamburger');
        const navLinks = document.getElementById('navLinks');
        
        if (hamburger) {
            hamburger.addEventListener('click', () => {
                navLinks.classList.toggle('active');
            });
        }

        // Close mobile menu when clicking a link
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', () => {
                navLinks.classList.remove('active');
            });
        });
    </script>
    
    <!-- Footer Script - Load last -->
    <script src="assets/js/footer.js" defer></script>

</body>
</html>
